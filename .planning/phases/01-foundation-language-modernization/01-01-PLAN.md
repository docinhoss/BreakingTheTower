---
phase: 01-foundation-language-modernization
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - pom.xml
  - src/main/java/com/mojang/tower/*.java
autonomous: true

must_haves:
  truths:
    - "Project compiles with Java 21 using Maven"
    - "Game runs from Maven-built JAR with identical behavior"
    - "Test directory structure exists for JUnit 5"
  artifacts:
    - path: "pom.xml"
      provides: "Maven build configuration with Java 21 and test dependencies"
      contains: "maven.compiler.source>21"
    - path: "src/main/java/com/mojang/tower/TowerComponent.java"
      provides: "Main game class in Maven structure"
    - path: "src/test/java/.gitkeep"
      provides: "Test directory placeholder"
  key_links:
    - from: "pom.xml"
      to: "src/main/java"
      via: "Maven source directory configuration"
      pattern: "sourceDirectory"
---

<objective>
Set up Maven build infrastructure and migrate source files to standard Maven structure with Java 21 compilation.

Purpose: Establish the build foundation for golden master testing and modern Java features. Maven provides dependency management (JUnit 5, Jackson) and standard directory structure.

Output: Working Maven project that compiles and runs the game on Java 21.
</objective>

<execution_context>
@/home/docinhos/.claude/get-shit-done/workflows/execute-plan.md
@/home/docinhos/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-foundation-language-modernization/01-CONTEXT.md
@.planning/phases/01-foundation-language-modernization/01-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Maven project structure with pom.xml</name>
  <files>
    pom.xml
    src/main/java/.gitkeep
    src/main/resources/.gitkeep
    src/test/java/.gitkeep
    src/test/resources/golden/.gitkeep
  </files>
  <action>
Create pom.xml with:
- groupId: com.mojang
- artifactId: tower
- version: 1.0-SNAPSHOT
- Java 21 source/target via maven.compiler.source and maven.compiler.target properties
- JUnit 5 (5.10.2) dependency with test scope
- Jackson Databind (2.16.1) dependency with test scope
- maven-compiler-plugin 3.12.1 configured for Java 21
- maven-surefire-plugin 3.2.5 for test execution
- maven-jar-plugin configured with Main-Class: com.mojang.tower.TowerComponent

Create standard Maven directories:
- src/main/java/ (for source files)
- src/main/resources/ (for res/ assets later)
- src/test/java/ (for test classes)
- src/test/resources/golden/ (for golden master snapshots)

Use .gitkeep files to ensure empty directories are tracked.

Reference the exact pom.xml structure from 01-RESEARCH.md.
  </action>
  <verify>
Run: `ls pom.xml src/main/java src/test/java src/test/resources/golden`
All paths exist.
  </verify>
  <done>Maven project structure exists with pom.xml containing Java 21 configuration and test dependencies.</done>
</task>

<task type="auto">
  <name>Task 2: Migrate source and resource files to Maven structure</name>
  <files>
    src/main/java/com/mojang/tower/*.java
    src/main/resources/sheet.gif
    src/main/resources/island.gif
    src/main/resources/logo.gif
    src/main/resources/winscreen.gif
  </files>
  <action>
1. Move all .java files from src/com/mojang/tower/ to src/main/java/com/mojang/tower/
   - Keep the same package structure (com.mojang.tower)
   - All 21 Java files should be moved

2. Copy resource files from res/ to src/main/resources/
   - sheet.gif, island.gif, logo.gif, winscreen.gif
   - Keep originals in res/ for hot-reload feature

3. Update Bitmaps.java resource loading paths if needed:
   - Check if getResource() calls work with classpath loading
   - The code uses getResource("/sheet.gif") pattern which should work from src/main/resources

4. Verify Maven compilation:
   - Run: mvn compile
   - Fix any compilation errors (should be none - pure file move)

5. Verify game runs:
   - Run: mvn exec:java -Dexec.mainClass=com.mojang.tower.TowerComponent
   - Or: mvn package && java -jar target/tower-1.0-SNAPSHOT.jar
   - Game should start and display title screen

Note: The game uses relative paths for hot-reload. The original res/ folder stays for development. Maven resources are for packaged JAR.
  </action>
  <verify>
Run: `mvn compile` - succeeds with no errors
Run: `mvn package -DskipTests` - produces target/tower-1.0-SNAPSHOT.jar
Run: `java -jar target/tower-1.0-SNAPSHOT.jar` - game window opens (manual verify optional)
  </verify>
  <done>All source files compile with Java 21 via Maven. Game runs from Maven-built JAR.</done>
</task>

</tasks>

<verification>
1. `mvn --version` shows Maven 3.x with Java 21
2. `mvn compile` succeeds with no errors
3. `mvn package -DskipTests` produces executable JAR
4. pom.xml contains: junit-jupiter 5.10.2, jackson-databind 2.16.1, maven.compiler.source 21
</verification>

<success_criteria>
- pom.xml exists with correct Java 21 and dependency configuration
- src/main/java/com/mojang/tower/ contains all 21 Java files
- src/main/resources/ contains game assets (4 GIF files)
- src/test/java/ and src/test/resources/golden/ directories exist
- `mvn compile` succeeds
- `mvn package -DskipTests` produces runnable JAR
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation-language-modernization/01-01-SUMMARY.md`
</output>
